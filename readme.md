# CLUENER2020

æœ¬é¡¹ç›®æ˜¯è®¡ç®—è¯­è¨€å­¦è¯¾ç¨‹ä½œä¸šçš„ä»£ç å®ç°ã€‚æ•°æ®é›†æ¥è‡ªCLUENER2020ä»»åŠ¡ã€‚

## Dataset

å®éªŒæ•°æ®æ¥è‡ªCLUENER2020ï¼Œæ˜¯ä¸€ä¸ªä¸­æ–‡ç»†ç²’åº¦å‘½åå®ä½“è¯†åˆ«æ•°æ®é›†ï¼Œæ˜¯åŸºäºå¼€æºæ–‡æœ¬åˆ†ç±»æ•°æ®é›†THUCNEWSï¼Œé€‰å‡ºéƒ¨åˆ†æ•°æ®è¿›è¡Œç»†ç²’åº¦æ ‡æ³¨å¾—åˆ°çš„ã€‚è¯¥æ•°æ®é›†çš„è®­ç»ƒé›†ã€éªŒè¯é›†å’Œæµ‹è¯•é›†çš„å¤§å°åˆ†åˆ«ä¸º10748ï¼Œ1343ï¼Œ1345ï¼Œå¹³å‡å¥å­é•¿åº¦37.4å­—ï¼Œæœ€é•¿50å­—ã€‚ç”±äºæµ‹è¯•é›†ä¸ç›´æ¥æä¾›ï¼Œä½œä¸šè€ƒè™‘åˆ°leaderboardä¸Šæäº¤æ¬¡æ•°æœ‰é™ï¼Œè¦æ±‚ä½¿ç”¨éªŒè¯é›†ä½œä¸ºæ¨¡å‹è¡¨ç°è¯„åˆ¤çš„æµ‹è¯•é›†ã€‚

CLUENER2020å…±æœ‰10ä¸ªä¸åŒçš„ç±»åˆ«ï¼ŒåŒ…æ‹¬ï¼šç»„ç»‡(organization)ã€äººå(name)ã€åœ°å€(address)ã€å…¬å¸(company)ã€æ”¿åºœ(government)ã€ä¹¦ç±(book)ã€æ¸¸æˆ(game)ã€ç”µå½±(movie)ã€èŒä½(position)å’Œæ™¯ç‚¹(scene)ã€‚

åŸå§‹æ•°æ®åˆ†åˆ«ä½äº./data/clue/è·¯å¾„ä¸‹çš„train.jsonå’Œtest.jsonæ–‡ä»¶ä¸­ï¼Œæ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œæ˜¯ä¸€æ¡å•ç‹¬çš„æ•°æ®ï¼Œä¸€æ¡æ•°æ®åŒ…æ‹¬ä¸€ä¸ªåŸå§‹å¥å­ä»¥åŠå…¶ä¸Šçš„æ ‡ç­¾ï¼Œå…·ä½“å½¢å¼å¦‚ä¸‹ï¼š

```
{
	"text": "æµ™å•†é“¶è¡Œä¼ä¸šä¿¡è´·éƒ¨å¶è€æ¡‚åšå£«åˆ™ä»å¦ä¸€ä¸ªè§’åº¦å¯¹äº”é“é—¨æ§›è¿›è¡Œäº†è§£è¯»ã€‚å¶è€æ¡‚è®¤ä¸ºï¼Œå¯¹ç›®å‰å›½å†…å•†ä¸šé“¶è¡Œè€Œè¨€ï¼Œ",
	"label": {
		"name": {
			"å¶è€æ¡‚": [
				[9, 11],
				[32, 34]
			]
		},
		"company": {
			"æµ™å•†é“¶è¡Œ": [
				[0, 3]
			]
		}
	}
}

```

## Requirements

This repo was tested on Python 3.6+ and PyTorch 1.5.1. The main requirements are:

- tqdm
- scikit-learn
- pytorch >= 1.5.1
- ğŸ¤—transformers == 2.2.2

To get the environment settled, run:

```
pip install -r requirements.txt
```

## Results

å„ä¸ªæ¨¡å‹åœ¨æ•°æ®é›†ä¸Šçš„ç»“æœï¼ˆf1 scoreï¼‰å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼šï¼ˆRobertaå‡æŒ‡RoBERTa-wwm-ext-largeæ¨¡å‹ï¼‰

| æ¨¡å‹         | BiLSTM+CRF | Roberta+Softmax | Roberta+CRF | Roberta+BiLSTM+CRF |
| ------------ | ---------- | --------------- | ----------- | ------------------ |
| address      | 45.87      | 57.49           | 62.35       | **63.15**          |
| book         | 68.57      | 75.31           | 80.27       | **81.45**          |
| company      | 68.65      | 76.71           | 78.75       | **80.62**          |
| game         | 80.00      | 82.9            | 82.39       | **85.57**          |
| government   | 70.52      | 79.01           | 80.00       | 81.31              |
| movie        | 74.40      | 83.22           | 84.84       | **85.61**          |
| name         | 70.00      | 88.11           | 87.58       | **88.22**          |
| organization | 71.98      | 74.3            | 79.14       | **80.53**          |
| position     | 72.51      | 77.39           | **79.86**   | 78.82              |
| scene        | 52.20      | 62.55           | 66.00       | **72.86**          |
| **overall**  | 67.31      | 75.89           | 78.21       | **79.64**          |

## Pretrained Model Required

éœ€è¦æå‰ä¸‹è½½BERTçš„é¢„è®­ç»ƒæ¨¡å‹ï¼ŒåŒ…æ‹¬

- pytorch_model.bin
- vocab.txt

æ”¾ç½®åœ¨./pretrained_bert_modelså¯¹åº”çš„é¢„è®­ç»ƒæ¨¡å‹æ–‡ä»¶å¤¹ä¸‹ï¼Œå…¶ä¸­

**bert-base-chineseæ¨¡å‹ï¼š**[ä¸‹è½½åœ°å€](https://storage.googleapis.com/bert_models/2018_11_03/chinese_L-12_H-768_A-12.zip) ã€‚

æ³¨æ„ï¼Œä»¥ä¸Šä¸‹è½½åœ°å€ä»…æä¾›tensorflowç‰ˆæœ¬ï¼Œéœ€è¦æ ¹æ®[huggingface suggest](https://huggingface.co/transformers/converting_tensorflow_models.html)å°†å…¶è½¬æ¢ä¸ºpytorchç‰ˆæœ¬ã€‚

**chinese_roberta_wwm_largeæ¨¡å‹ï¼š**[ä¸‹è½½åœ°å€](https://github.com/ymcui/Chinese-BERT-wwm#%E4%BD%BF%E7%94%A8%E5%BB%BA%E8%AE%AE) ã€‚

## Parameter Setting

### 1.model parameters

åœ¨./experiments/clue/config.jsonä¸­è®¾ç½®äº†Robertaæ¨¡å‹çš„åŸºæœ¬å‚æ•°ï¼Œè€Œåœ¨./pretrained_bert_modelsä¸‹çš„ä¸¤ä¸ªé¢„è®­ç»ƒæ–‡ä»¶å¤¹ä¸­ï¼Œconfig.jsoné™¤äº†è®¾ç½®RobertaåŸºæœ¬å‚æ•°å¤–ï¼Œè¿˜è®¾ç½®äº†'X'æ¨¡å‹ï¼ˆå¦‚LSTMï¼‰å‚æ•°ï¼Œå¯æ ¹æ®éœ€è¦è¿›è¡Œæ›´æ”¹ã€‚

### 2.other parameters

ç¯å¢ƒè·¯å¾„ä»¥åŠå…¶ä»–è¶…å‚æ•°åœ¨./config.pyä¸­è¿›è¡Œè®¾ç½®ã€‚

## Usage

æ‰“å¼€æŒ‡å®šæ¨¡å‹å¯¹åº”çš„ç›®å½•ï¼Œå‘½ä»¤è¡Œè¾“å…¥ï¼š

```
python run.py
```

æ¨¡å‹è¿è¡Œç»“æŸåï¼Œæœ€ä¼˜æ¨¡å‹pytorch_model.binå’Œè®­ç»ƒlogä¿å­˜åœ¨./experiments/clue/è·¯å¾„ä¸‹ã€‚åœ¨æµ‹è¯•é›†ä¸­çš„bad caseä¿å­˜åœ¨./case/bad_case.txtä¸­ã€‚

## Attention

ç›®å‰ï¼Œå½“å‰æ¨¡å‹çš„train.logå·²ä¿å­˜åœ¨./experiments/clue/è·¯å¾„ä¸‹ï¼Œå¦‚è¦é‡æ–°è¿è¡Œæ¨¡å‹ï¼Œè¯·å…ˆå°†train.logç§»å‡ºå½“å‰è·¯å¾„ï¼Œä»¥å…è¦†ç›–ã€‚

